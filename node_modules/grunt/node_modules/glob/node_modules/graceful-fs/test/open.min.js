var test=require("tap").test;var fs=require("../graceful-fs.js");test("graceful fs is not fs",function(a){a.notEqual(fs,require("fs"));a.end()});test("open an existing file works",function(b){var c=fs._curOpen;var a=fs.openSync(__filename,"r");b.equal(fs._curOpen,c+1);fs.closeSync(a);b.equal(fs._curOpen,c);fs.open(__filename,"r",function(e,d){if(e){throw e}b.equal(fs._curOpen,c+1);fs.close(d,function(f){if(f){throw f}b.equal(fs._curOpen,c);b.end()})})});test("open a non-existing file throws",function(c){var e=fs._curOpen;var d;try{var b=fs.openSync("this file does not exist","r")}catch(a){d=a}c.ok(d,"should throw");c.notOk(b,"should not get an fd");c.equal(d.code,"ENOENT");c.equal(fs._curOpen,e);fs.open("neither does this file","r",function(g,f){c.ok(g,"should throw");c.notOk(f,"should not get an fd");c.equal(g.code,"ENOENT");c.equal(fs._curOpen,e);c.end()})});