var fs=require("graceful-fs");var test=require("tap").test;var glob=require("../");test("mock fs",function(d){var e=fs.stat;var f=fs.statSync;var b=fs.readdir;var c=fs.readdirSync;function a(i){var h;switch(i.toLowerCase()){case"/tmp":case"/tmp/":h={isDirectory:function(){return true}};break;case"/tmp/a":h={isDirectory:function(){return false}};break}return h}fs.stat=function(j,h){var i=a(j);if(i){process.nextTick(function(){h(null,i)})}else{e.call(fs,j,h)}};fs.statSync=function(h){return a(h)||f.call(fs,h)};function g(i){var h;switch(i.toLowerCase()){case"/tmp":case"/tmp/":h=["a","A"];break;case"/":h=["tmp","tMp","tMP","TMP"]}return h}fs.readdir=function(j,h){var i=g(j);if(i){process.nextTick(function(){h(null,i)})}else{b.call(fs,j,h)}};fs.readdirSync=function(h){return g(h)||c.call(fs,h)};d.pass("mocked");d.end()});test("nocase, nomagic",function(a){var c=2;var b=["/TMP/A","/TMP/a","/tMP/A","/tMP/a","/tMp/A","/tMp/a","/tmp/A","/tmp/a"];glob("/tmp/a",{nocase:true},function(e,d){if(e){throw e}a.same(d.sort(),b);if(--c===0){a.end()}});glob("/tmp/A",{nocase:true},function(e,d){if(e){throw e}a.same(d.sort(),b);if(--c===0){a.end()}})});test("nocase, with some magic",function(a){a.plan(2);var b=["/TMP/A","/TMP/a","/tMP/A","/tMP/a","/tMp/A","/tMp/a","/tmp/A","/tmp/a"];glob("/tmp/*",{nocase:true},function(d,c){if(d){throw d}a.same(c.sort(),b)});glob("/tmp/*",{nocase:true},function(d,c){if(d){throw d}a.same(c.sort(),b)})});