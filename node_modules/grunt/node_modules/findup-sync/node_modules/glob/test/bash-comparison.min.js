var tap=require("tap"),child_process=require("child_process"),bashResults=require("./bash-results.json"),globs=Object.keys(bashResults),glob=require("../"),path=require("path");process.chdir(path.resolve(__dirname,".."));function alphasort(d,c){d=d.toLowerCase();c=c.toLowerCase();return d>c?1:d<c?-1:0}globs.forEach(function(b){var a=bashResults[b];if(process.platform==="win32"&&a.some(function(c){return/\/symlink\//.test(c)})){return}tap.test(b,function(c){glob(b,function(e,d){if(e){throw e}d=cleanResults(d);c.deepEqual(d,a,b);c.end()})});tap.test(b+" sync",function(c){var d=cleanResults(glob.sync(b));c.deepEqual(d,a,"should match shell");c.end()})});function cleanResults(a){return a.map(function(b){return b.replace(/\/+/g,"/").replace(/\/$/,"")}).sort(alphasort).reduce(function(c,b){if(b!==c[c.length-1]){c.push(b)}return c},[]).sort(alphasort).map(function(b){return(process.platform!=="win32")?b:b.replace(/^[a-zA-Z]:[\/\\]+/,"/").replace(/[\\\/]+/g,"/")})};