var test=require("tap").test;var glob=require("../");process.chdir(__dirname);var lag=5;glob.Glob.prototype._stat=function(a){return function(d,b){var c=arguments;setTimeout(function(){a.call(this,d,b)}.bind(this),lag+=5)}}(glob.Glob.prototype._stat);test("mark, with **",function(a){glob("a/*b*/**",{mark:true},function(d,b){if(d){throw d}var c=["a/abcdef/","a/abcdef/g/","a/abcdef/g/h","a/abcfed/","a/abcfed/g/","a/abcfed/g/h","a/b/","a/b/c/","a/b/c/d","a/bc/","a/bc/e/","a/bc/e/f","a/cb/","a/cb/e/","a/cb/e/f"];a.same(b,c);a.end()})});test("mark, no / on pattern",function(a){glob("a/*",{mark:true},function(d,b){if(d){throw d}var c=["a/abcdef/","a/abcfed/","a/b/","a/bc/","a/c/","a/cb/"];if(process.platform!=="win32"){c.push("a/symlink/")}a.same(b,c);a.end()}).on("match",function(b){a.similar(b,/\/$/)})});test("mark=false, no / on pattern",function(a){glob("a/*",function(d,b){if(d){throw d}var c=["a/abcdef","a/abcfed","a/b","a/bc","a/c","a/cb"];if(process.platform!=="win32"){c.push("a/symlink")}a.same(b,c);a.end()}).on("match",function(b){a.similar(b,/[^\/]$/)})});test("mark=true, / on pattern",function(a){glob("a/*/",{mark:true},function(d,b){if(d){throw d}var c=["a/abcdef/","a/abcfed/","a/b/","a/bc/","a/c/","a/cb/"];if(process.platform!=="win32"){c.push("a/symlink/")}a.same(b,c);a.end()}).on("match",function(b){a.similar(b,/\/$/)})});test("mark=false, / on pattern",function(a){glob("a/*/",function(d,b){if(d){throw d}var c=["a/abcdef/","a/abcfed/","a/b/","a/bc/","a/c/","a/cb/"];if(process.platform!=="win32"){c.push("a/symlink/")}a.same(b,c);a.end()}).on("match",function(b){a.similar(b,/\/$/)})});