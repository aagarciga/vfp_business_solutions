var inserted,Module=require("module"),fs=require("fs"),existingExtFn=Module._extensions[".js"],amdefineRegExp=/amdefine\.js/;inserted="if (typeof define !== 'function') {var define = require('amdefine')(module)}";function stripBOM(a){if(a.charCodeAt(0)===65279){a=a.slice(1)}return a}function intercept(b,a){var c=stripBOM(fs.readFileSync(a,"utf8"));if(!amdefineRegExp.test(b.id)){c=inserted+c}b._compile(c,a)}intercept._id="amdefine/intercept";if(!existingExtFn._id||existingExtFn._id!==intercept._id){Module._extensions[".js"]=intercept};