(function(){var a=window.AmCharts;a.AmPieChart=a.Class({inherits:a.AmSlicedChart,construct:function(b){this.type="pie";a.AmPieChart.base.construct.call(this,b);this.cname="AmPieChart";this.pieBrightnessStep=30;this.minRadius=10;this.depth3D=0;this.startAngle=90;this.angle=this.innerRadius=0;this.startRadius="500%";this.pullOutRadius="20%";this.labelRadius=20;this.labelText="[[title]]: [[percents]]%";this.balloonText="[[title]]: [[percents]]% ([[value]])\n[[description]]";this.previousScale=1;this.adjustPrecision=!1;a.applyTheme(this,b,this.cname)},drawChart:function(){a.AmPieChart.base.drawChart.call(this);var Y=this.chartData;if(a.ifArray(Y)){if(0<this.realWidth&&0<this.realHeight){a.VML&&(this.startAlpha=1);var V=this.startDuration,Z=this.container,aa=this.updateWidth();this.realWidth=aa;var R=this.updateHeight();this.realHeight=R;var X=a.toCoordinate,W=X(this.marginLeft,aa),ab=X(this.marginRight,aa),s=X(this.marginTop,R)+this.getTitleHeight(),S=X(this.marginBottom,R),P,O,T,j=a.toNumber(this.labelRadius),Q=this.measureMaxLabel();Q>this.maxLabelWidth&&(Q=this.maxLabelWidth);this.labelText&&this.labelsEnabled||(j=Q=0);P=void 0===this.pieX?(aa-W-ab)/2+W:X(this.pieX,this.realWidth);O=void 0===this.pieY?(R-s-S)/2+s:X(this.pieY,R);T=X(this.radius,aa,R);T||(aa=0<=j?aa-W-ab-2*Q:aa-W-ab,R=R-s-S,T=Math.min(aa,R),R<aa&&(T/=1-this.angle/90,T>aa&&(T=aa)),R=a.toCoordinate(this.pullOutRadius,T),T=(0<=j?T-1.8*(j+R):T-1.8*R)/2);T<this.minRadius&&(T=this.minRadius);R=X(this.pullOutRadius,T);s=a.toCoordinate(this.startRadius,T);X=X(this.innerRadius,T);X>=T&&(X=T-1);S=a.fitToBounds(this.startAngle,0,360);0<this.depth3D&&(S=270<=S?270:90);S-=90;360<S&&(S-=360);aa=T-T*this.angle/90;for(W=Q=0;W<Y.length;W++){ab=Y[W],!0!==ab.hidden&&(Q+=a.roundTo(ab.percents,this.pf.precision))}Q=a.roundTo(Q,this.pf.precision);this.tempPrec=NaN;this.adjustPrecision&&100!=Q&&(this.tempPrec=this.pf.precision+1);for(var K,W=0;W<Y.length;W++){if(ab=Y[W],!0!==ab.hidden&&(this.showZeroSlices||0!==ab.percents)){var M=360*ab.percents/100,Q=Math.sin((S+M/2)/180*Math.PI),L=-Math.cos((S+M/2)/180*Math.PI)*(aa/T),N=this.outlineColor;N||(N=ab.color);var o=this.alpha;isNaN(ab.alpha)||(o=ab.alpha);N={fill:ab.color,stroke:N,"stroke-width":this.outlineThickness,"stroke-opacity":this.outlineAlpha,"fill-opacity":o};ab.url&&(N.cursor="pointer");N=a.wedge(Z,P,O,S,M,T,aa,X,this.depth3D,N,this.gradientRatio,ab.pattern,this.path);a.setCN(this,N,"pie-item");a.setCN(this,N.wedge,"pie-slice");a.setCN(this,N,ab.className,!0);this.addEventListeners(N,ab);ab.startAngle=S;Y[W].wedge=N;0<V&&(this.chartCreated||N.setAttr("opacity",this.startAlpha));ab.ix=Q;ab.iy=L;ab.wedge=N;ab.index=W;o=Z.set();if(this.labelsEnabled&&this.labelText&&ab.percents>=this.hideLabelsPercent){var U=S+M/2;0>U&&(U+=360);360<U&&(U-=360);var J=j;isNaN(ab.labelRadius)||(J=ab.labelRadius);var M=P+Q*(T+J),I=O+L*(T+J),l,H=0;isNaN(K)&&350<U&&1<Y.length-W&&(K=W-1+Math.floor((Y.length-W)/2));if(0<=J){var i;90>=U&&0<=U?(i=0,l="start",H=8):90<=U&&180>U?(i=1,l="start",H=8):180<=U&&270>U?(i=2,l="end",H=-8):270<=U&&357>=U?(i=3,l="end",H=-8):357<=U&&(W>K?(i=0,l="start",H=8):(i=3,l="end",H=-8));ab.labelQuarter=i}else{l="middle"}U=this.formatString(this.labelText,ab);(J=this.labelFunction)&&(U=J(ab,U));J=ab.labelColor;J||(J=this.color);if(""!==U){U=a.wrappedText(Z,U,J,this.fontFamily,this.fontSize,l,!1,this.maxLabelWidth);a.setCN(this,U,"pie-label");a.setCN(this,U,ab.className,!0);U.translate(M+1.5*H,I);U.node.style.pointerEvents="none";ab.ty=I;ab.textX=M+1.5*H;var J=U.getBBox(),G=a.rect(Z,J.width+5,J.height+5,"#FFFFFF",0.005);G.translate(M+1.5*H+J.x,I+J.y);ab.hitRect=G;o.push(U);o.push(G);this.axesSet.push(o);ab.labelSet=o;ab.label=U}ab.tx=M;ab.tx2=M+H;ab.tx0=P+Q*T;ab.ty0=O+L*T}M=X+(T-X)/2;ab.pulled&&(M+=this.pullOutRadiusReal);ab.balloonX=Q*M+P;ab.balloonY=L*M+O;ab.startX=Math.round(Q*s);ab.startY=Math.round(L*s);ab.pullX=Math.round(Q*R);ab.pullY=Math.round(L*R);this.graphsSet.push(N);if(0===ab.alpha||0<V&&!this.chartCreated){N.hide(),o&&o.hide()}S+=360*ab.percents/100;360<S&&(S-=360)}}0<j&&this.arrangeLabels();this.pieXReal=P;this.pieYReal=O;this.radiusReal=T;this.innerRadiusReal=X;0<j&&this.drawTicks();this.initialStart();this.setDepths()}(Y=this.legend)&&Y.invalidateSize()}else{this.cleanChart()}this.dispDUpd()},setDepths:function(){var h=this.chartData,f;for(f=0;f<h.length;f++){var i=h[f],e=i.wedge,i=i.startAngle;0<=i&&180>i?e.toFront():180<=i&&e.toBack()}},arrangeLabels:function(){var h=this.chartData,f=h.length,i,e;for(e=f-1;0<=e;e--){i=h[e],0!==i.labelQuarter||i.hidden||this.checkOverlapping(e,i,0,!0,0)}for(e=0;e<f;e++){i=h[e],1!=i.labelQuarter||i.hidden||this.checkOverlapping(e,i,1,!1,0)}for(e=f-1;0<=e;e--){i=h[e],2!=i.labelQuarter||i.hidden||this.checkOverlapping(e,i,2,!0,0)}for(e=0;e<f;e++){i=h[e],3!=i.labelQuarter||i.hidden||this.checkOverlapping(e,i,3,!1,0)}},checkOverlapping:function(o,j,p,q,i){var n,k,r=this.chartData,s=r.length,h=j.label;if(h){if(!0===q){for(k=o+1;k<s;k++){r[k].labelQuarter==p&&(n=this.checkOverlappingReal(j,r[k],p))&&(k=s)}}else{for(k=o-1;0<=k;k--){r[k].labelQuarter==p&&(n=this.checkOverlappingReal(j,r[k],p))&&(k=0)}}!0===n&&100>i&&isNaN(j.labelRadius)&&(n=j.ty+3*j.iy,j.ty=n,h.translate(j.textX,n),j.hitRect&&(h=h.getBBox(),j.hitRect.translate(j.tx2,n+h.y)),this.checkOverlapping(o,j,p,q,i+1))}},checkOverlappingReal:function(j,h,l){var f=!1,k=j.label,i=h.label;j.labelQuarter!=l||j.hidden||h.hidden||!i||(k=k.getBBox(),l={},l.width=k.width,l.height=k.height,l.y=j.ty,l.x=j.tx,j=i.getBBox(),i={},i.width=j.width,i.height=j.height,i.y=h.ty,i.x=h.tx,a.hitTest(l,i)&&(f=!0));return f}})})();