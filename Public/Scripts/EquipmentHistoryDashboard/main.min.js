(function(d,f,c,g,e){var a=d.dandelion,b=a.namespace("App",d);b.EquipmentHistoryDashboard=(function(){var l,q,n,o,h,m,j;l={};q={itemsPerPage:0,currentPage:0};o={};h={dropdown:".dropdown",itemsPerPageSelector:".items-per-page-selector",statusSelector:".status-selector",btnActionFilesDialog:".btn-action-files-dialog",btnActionAdd:".btn-action-add",btnActionEdit:".btn-action-edit",btnActionView:".btn-action-view",dateRangePickerSingle:".daterangepicker-single",tableMain:"#equipmentHistoryDashboardTable",tableMainFieldWorkOrder:".field-workorder",tableMainFieldStatus:".field-status",modalEquipmentHistoryFormEdit:"#modal-equipment-history-form-edit"};j={modalEquipmentHistoryFormAdd:(function(w,z,D,y,G){var u,E,A,B,t,v,x;u={modalViewElement:"#modal-equipment-history-form-add",controlWorkOrder:".control-work-order",controlProjectManager:".control-project-manager",controlDateOut:".control-installdte",controlExpactedIn:".control-expdtein",controlReceived:".control-daterec"};E={usePlugins:function(){z(u.controlWorkOrder).select2({theme:"bootstrap",ajax:{url:l.workOrderSelectorAjaxUrl,dataType:"json",delay:250,processResults:function(J,K){K.page=K.page||1;return{results:J.items,pagination:{more:(K.page*30)<J.totalCount}}},cache:true},});z(u.controlProjectManager).select2({theme:"bootstrap",ajax:{url:l.projectManagerSelectorAjaxUrl,dataType:"json",delay:250,processResults:function(J,K){K.page=K.page||1;return{results:J.items,pagination:{more:(K.page*30)<J.totalCount}}},cache:true},})},reset:function(){x.reset();z(u.controlWorkOrder).val(null).trigger("change");z(u.controlProjectManager).val(null).trigger("change");z(u.controlDateOut).val("");z(u.controlExpactedIn).val("");z(u.controlReceived).val("")},saveHistoryCallback:function(){throw"Exception: Not implemented yet"}};A={saveHistory_OnDone:function(J){w.console.log(J);var K=z.parseJSON(J);w.console.log(K);E.saveHistoryCallback(K.equipid,K.ordnum,K.status);C()}};B=G.Model.extend({defaults:{equipid:"",ordnum:"",inspectno:"",installdte:"",expdtein:"",daterec:""}});t=function(K){var J=this;J.equipid=D.observable(K,"equipid");J.ordnum=D.observable(K,"ordnum");J.inspectno=D.observable(K,"inspectno");J.installdte=D.observable(K,"installdte");J.expdtein=D.observable(K,"expdtein");J.daterec=D.observable(K,"daterec");J.saveHistory=function(L){J.installdte(z(u.controlDateOut).val());J.expdtein(z(u.controlExpactedIn).val());J.daterec(z(u.controlReceived).val());z.post(l.addEquipmentHistoryUrl,{equipid:L.equipid(),ordnum:L.ordnum(),inspectno:L.inspectno(),installdte:L.installdte(),expdtein:L.expdtein(),daterec:L.daterec()}).done(A.saveHistory_OnDone).fail(function M(N){throw"POST Fail with :"+N})};J.reset=function(){J.equipid("");J.ordnum("");J.inspectno("");J.installdte("");J.expdtein("");J.daterec("")}};function H(){var J;J=w.document.getElementById(u.koViewElement);v=new B({});x=new t(v);y.applyBindings(x,J);E.usePlugins()}function F(J){E.reset();x.equipid(J);z(u.modalViewElement).modal("show")}function C(){z(u.modalViewElement).modal("hide")}function I(J){E.saveHistoryCallback=J}return{init:H,showFor:F,hide:C,setSaveHistoryCallback:I}}(d,f,c,g,e))};m={dropdown_OnClick:function(u){var t,v;t=f(this);v=t.html();t.parents(h.dropdown).find(".value").text(v)},itemsPerPageSelector_OnClick:function(t){q.itemsPerPage=f(this).html();q.currentPage=1;n.paginate()},statusSelector_OnClick:function(u){var t;t=f(this).html();throw"Exception: Not implemented yet. Do something with status: "+t},btnActionFilesDialog_OnClick:function(t){throw"Exception: Not implemented yet"},btnActionAdd_OnClick:function(t){j.modalEquipmentHistoryFormAdd.showFor(f(this).data("equipid"))},btnActionEdit_OnClick:function(t){f(h.modalEquipmentHistoryFormEdit).modal("show");throw"Exception: Not implemented yet"},btnActionView_OnClick:function(t){throw"Exception: Not implemented yet"}};n={bindEventHandlers:function(){f(h.dropdown).on("click","a",m.dropdown_OnClick);f(h.itemsPerPageSelector).on("click","a",m.itemsPerPageSelector_OnClick);f(h.statusSelector).on("click","a",m.statusSelector_OnClick);f(h.btnActionFilesDialog).on("click",m.btnActionFilesDialog_OnClick);f(h.btnActionAdd).on("click",m.btnActionAdd_OnClick);f(h.btnActionEdit).on("click",m.btnActionEdit_OnClick);f(h.btnActionView).on("click",m.btnActionView_OnClick)},usePlugins:function(){f(h.dateRangePickerSingle).daterangepicker({singleDatePicker:true,format:"YYYY-MM-DD",startDate:d.moment(),endDate:d.moment()})},paginate:function(){throw"Exception: Not implemented yet"},updateEquip:function(w,v,u){var t=f(h.tableMain).find("tr[data-equipid="+w+"]");t.find(h.tableMainFieldWorkOrder).text(v);t.find(h.tableMainFieldStatus).find(".value").text(u)}};function k(t){h.itemsPerPageSelector=t}function p(t){h.statusSelector=t}function r(t,u){o[t]=u}function i(u,t){l[u]=t}function s(u){var t;d.console.log("filter: ",u);d.console.log("HTML Bindings");for(t in h){if(h.hasOwnProperty(t)){d.console.log("\t",t,":",h[t])}}d.console.log("Binding Event Handlers");n.bindEventHandlers();d.console.log("Use Plugins");n.usePlugins();d.console.log("Dictionaries:");d.console.log(o);d.console.log("Initializing MVVM related logic:");for(t in j){if(j.hasOwnProperty(t)){d.console.log("\t",t,":",j[t]);j[t].init()}}j.modalEquipmentHistoryFormAdd.setSaveHistoryCallback(n.updateEquip)}return{init:s,setItemsPerPageSelector:k,setStatusSelector:p,addDictionary:r,addUrl:i}}())}(window,window.jQuery,window.kb,window.ko,window.Backbone));