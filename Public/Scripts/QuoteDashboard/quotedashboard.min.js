if(typeof jQuery==="undefined"){throw new Error("VFP Business Series's Quote Dashboard JavaScript requires jQuery")}if(typeof kb==="undefined"){throw new Error("VFP Business Series's Quote Dashboard JavaScript requires Knockback.js")}if(typeof ko==="undefined"){throw new Error("VFP Business Series's Quote Dashboard JavaScript requires Knockout.js")}if(typeof Backbone==="undefined"){throw new Error("VFP Business Series's Quote Dashboard JavaScript requires Backbone.js")}(function(d,e,c){var b=d.dandelion,a=b.namespace("App.QuoteDashboard",d);a.status={};a.status.itemsPerPage=50;a.status.table_header_sortLastButton=null;a.status.table_header_sortField="ordnum";a.status.table_header_sortFieldOrder="ASC";a.status.currentPage=1;a.dictionaries={};a.dictionaries.status=[{id:"0",descrip:"Empty"},{id:"1",descrip:"RFQ Received"},{id:"2",descrip:"Quote Prepared"},{id:"3",descrip:"Sent to Customer"},{id:"4",descrip:"CSR follow up"},{id:"5",descrip:"Revisions"},{id:"6",descrip:"NotÂ  approved"},{id:"7",descrip:"Quote approved"},{id:"8",descrip:"Billed"}];a.htmlBindings={};a.htmlBindings.container=".container";a.htmlBindings.itemCounter="#panelHeadingItemsCount";a.htmlBindings.drpItemPerPage=".top-pager-itemmperpage-control a";a.htmlBindings.drpItemPerPageValue=".top-pager-itemmperpage-control button span.value";a.htmlBindings.table="#quoteDashboardTable";a.htmlBindings.table_header_btnSort=".btn-table-sort";a.htmlBindings.table_body_btnQuoteNo=".qutno-form-link";a.htmlBindings.table_body_btnAttach=".btn-files-dialog";a.htmlBindings.pager_container=".pager-wrapper";a.htmlBindings.pager_btnPagerPages=".pager-btn";a.functions={};a.functions.paginate=function(){e.ajax({data:{predicate:"",page:a.status.currentPage,itemsPerPage:a.status.itemsPerPage,orderby:a.status.table_header_sortField,order:a.status.table_header_sortFieldOrder},url:a.urls.getPage,type:"post",beforeSend:function(){e(".loading").show()},success:function(i){var j=e.parseJSON(i),f=new BootstrapPager(j,a.eventHandlers.pager_btnPagerPages_onClick),h=f.getCurrentPagedItems(),g=f.getPagerControl();e(a.htmlBindings.pager_container).empty().append(g);a.functions.updateTable(h);e(a.htmlBindings.itemCounter).html(f.itemsCount);e(".loading").hide()}})};a.functions.getDictionaries=function(){};a.functions.updateTable=function(f){var h=e(a.htmlBindings.table),i=h.children("tbody"),g;i.empty();for(g in f){if(f.hasOwnProperty(g)){i.append(a.functions.buildTableItem(f[g],"","item-field"))}}a.functions.bindTableItemsEventHandlers()};a.functions.buildTableItem=function(r,m,p){var A=d.document,n=A.createElement("tr"),u=function(B){var C=A.createElement("td");C.className=p;C.appendChild(A.createTextNode(B));return C},i=function(E,D,B){var F=A.createElement("td"),C=A.createElement("a");C.href="#";C.className=D;C.dataset.ordnum=r.ordnum;if(typeof E==="string"){C.appendChild(A.createTextNode(E))}else{C.appendChild(E)}F.className=B||p;F.appendChild(C);return F},k=function(H,D){var E,G,C,F,B=A.createElement("select");G=A.createElement("option");G.appendChild(A.createTextNode("Empty"));B.appendChild(G);for(E in D){if(D.hasOwnProperty(E)){C=D[E].id;F=D[E].descrip;G=A.createElement("option");if(H===C){G.selected="selected"}G.value=C;G.appendChild(A.createTextNode(F));B.appendChild(G)}}B.className="form-control update-dropdown";return B},h=function(D,F,C){var E=A.createElement("td"),B=k(D,F);B.dataset.ordnum=r.ordnum;B.className+=" select2-nosearch "+C;E.appendChild(B);return E},f=function(){return i(r.qutno,a.htmlBindings.table_body_btnQuoteNo.slice(1))},s=function(){return u(r.projno)},j=function(){return u(r.company)},o=function(){return u(r.vesselid)},z=function(){return u(r.sotypecode)},g=function(){return u(r.jobdescrip)},w=function(){return h(r.status,a.dictionaries.status,"status")},q=function(){return u(r.qutdate)},v=function(){return u(r.ordnum)},l=function(){return u(r.cstctid)},x=function(){return u(r.projectManager1)},y=function(){return u(r.projectManager2)},t=function(){var B=A.createElement("span");B.className="glyphicon glyphicon-folder-close";return i(B,a.htmlBindings.table_body_btnAttach.slice(1),"item-action item-files")};n.className=m;n.appendChild(f());n.appendChild(s());n.appendChild(j());n.appendChild(o());n.appendChild(z());n.appendChild(g());n.appendChild(w());n.appendChild(q());n.appendChild(v());n.appendChild(l());n.appendChild(x());n.appendChild(y());n.appendChild(t());return n};a.functions.bindTableItemsEventHandlers=function(){console.log("todo: bindTableItemsEventHandlers")};a.functions.bindEventHandlers=function(){e(a.htmlBindings.drpItemPerPage).on("click",a.eventHandlers.drpItemPerPage_onClick);e(a.htmlBindings.table_header_btnSort).on("click",a.eventHandlers.table_body_btnSalesOrder_onClick);e(a.htmlBindings.pager_btnPagerPages).on("click",a.eventHandlers.pager_btnPagerPages_onClick);a.functions.bindTableItemsEventHandlers()};a.eventHandlers={};a.eventHandlers.drpItemPerPage_onClick=function(g){var f=e(g.target),h=f.html();a.status.itemsPerPage=h;e(a.htmlBindings.drpItemPerPageValue).text(h);a.status.currentPage=1;a.functions.paginate()};a.eventHandlers.pager_btnPagerPages_onClick=function(g){var f=e(g.target),h=f.data("page");a.status.currentPage=h;a.functions.paginate()};a.eventHandlers.table_body_btnSalesOrder_onClick=function(g){var f=e(g.target),h=f.data("field");if(a.status.table_header_sortLastButton!==null){a.status.table_header_sortLastButton.removeClass("asc desc")}if(a.status.table_header_sortField!==h){a.status.table_header_sortFieldOrder=""}a.status.table_header_sortField=h;if(a.status.table_header_sortFieldOrder==="ASC"){a.status.table_header_sortFieldOrder="DESC";f.addClass("asc").removeClass("desc")}else{a.status.table_header_sortFieldOrder="ASC";f.addClass("desc").removeClass("asc")}a.status.table_header_sortLastButton=f;a.functions.paginate()};a.eventHandlers.table_body_drpstatus_onChange=function(f){};a.init=function(f){a.status.itemsPerPage=e(a.htmlBindings.drpItemPerPageValue).text();a.functions.getDictionaries();a.functions.bindEventHandlers()}}(window,jQuery,App));