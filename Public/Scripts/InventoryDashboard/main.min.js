(function(){var e,c,f,b,a,d;d=window;e=d.jQuery;c=d.App;a=d.dandelion;b=a.namespace("App.InventoryDashboard",d);f=c.InventoryDashboard.DynamicFilter;b.status={};b.status.itemsPerPage=50;b.status.table_header_sortLastButton=null;b.status.table_header_sortField="itemno";b.status.table_header_sortFieldOrder="ASC";b.status.currentPage=1;b.status.currentCustno="";b.status.currentSet="details";b.status.currentBalance="0.0";b.dictionaries={};b.htmlBindings={};b.htmlBindings.container=".container";b.htmlBindings.itemCounter="#panelHeadingItemsCount";b.htmlBindings.drpItemPerPage=".top-pager-itemmperpage-control a";b.htmlBindings.drpItemPerPageValue=".top-pager-itemmperpage-control button span.value";b.htmlBindings.filterForm="#filterForm";b.htmlBindings.table="#inventoryDashboardTable";b.htmlBindings.table_header_btnSort=".btn-table-sort";b.htmlBindings.pager_container=".pager-wrapper";b.htmlBindings.pager_btnPagerPages=".pager-btn";b.functions={};b.functions.paginate=function(){e.ajax({data:{predicate:b.DynamicFilter.functions.getPredicate(),page:b.status.currentPage,itemsPerPage:b.status.itemsPerPage,orderby:b.status.table_header_sortField,order:b.status.table_header_sortFieldOrder},url:b.urls.getPage,type:"post",beforeSend:function(){return e(".loading").show()},success:function(j,m,k){var l,g,i,h;l=e.parseJSON(j);g=new BootstrapPager(l,b.eventHandlers.pager_btnPagerPages_onClick);h=g.getCurrentPagedItems();i=g.getPagerControl();e(b.htmlBindings.pager_container).empty().append(i);b.functions.updateTable(h);e(b.htmlBindings.itemCounter).html(g.itemsCount);return e(".loading").hide()}});return this};b.functions.updateTable=function(g){var i,j,h;i=e(b.htmlBindings.table);j=i.children("tbody");j.empty();for(h in g){if(g.hasOwnProperty(h)){j.append(b.functions.buildTableItem(g[h],"","item-field"))}}b.functions.bindTableItemsEventHandlers();return this};b.functions.buildTableItem=function(n,t,q){var s,u,o,r,h,m,p,k,j,g,i,l;s=d.document;u=s.createElement("tr");r=function(w,v){var x;x=s.createElement("td");x.className=v;x.appendChild(s.createTextNode(w));return x};i=function(y,x,v){var w,z;z=s.createElement("td");w=s.createElement("a");w.href="#";w.className=x;w.dataset.custno=n.custno;if(typeof y==="string"){w.appendChild(s.createTextNode(y))}else{w.appendChild(y)}z.className=v||q;z.appendChild(w);return z};o=function(B,x){var w,A,y,z,v;v=s.createElement("select");z=s.createElement("option");z.appendChild(s.createTextNode("Empty"));v.appendChild(z);for(y in x){if(x.hasOwnProperty(y)){w=x[y].id;A=x[y].descrip;z=s.createElement("option");if(B===w){z.selected="selected"}z.value=w;z.appendChild(s.createTextNode(A));v.appendChild(z)}}v.className="form-control update-dropdown";return v};l=function(x,z,w){var v,y;y=s.createElement("td");v=o(x,z);v.dataset.ordnum=n.ordnum;v.className+=" select2-nosearch "+w;y.appendChild(v);return y};p=function(){return r(n.itemno)};k=function(){return r(n.itmwhs)};m=function(){return r(n.descrip)};j=function(){return r(n.onhand)};g=function(){return r(n.onorder)};h=function(){return r(n.committed)};u.className=t;u.appendChild(p());u.appendChild(k());u.appendChild(m());u.appendChild(j());u.appendChild(g());u.appendChild(h());return u};b.functions.bindTableItemsEventHandlers=function(){return this};b.functions.bindEventHandlers=function(){e(b.htmlBindings.drpItemPerPage).on("click",b.eventHandlers.drpItemPerPage_onClick);e(b.htmlBindings.table_header_btnSort).on("click",b.eventHandlers.table_body_btnSort_onClick);e(b.htmlBindings.pager_btnPagerPages).on("click",b.eventHandlers.pager_btnPagerPages_onClick);b.functions.bindTableItemsEventHandlers();return this};b.eventHandlers={};b.eventHandlers.drpItemPerPage_onClick=function(h){var g,i;g=e(h.target);i=g.html();b.status.itemsPerPage=i;e(b.htmlBindings.drpItemPerPageValue).text(i);b.status.currentPage=1;b.functions.paginate();return this};b.eventHandlers.pager_btnPagerPages_onClick=function(h){var g,i;g=e(h.target);i=g.data("page");b.status.currentPage=i;b.functions.paginate();return this};b.eventHandlers.table_body_btnSort_onClick=function(h){var g,i;g=e(h.target);i=g.data("field");if(b.status.table_header_sortLastButton!==null){b.status.table_header_sortLastButton.removeClass("asc desc")}if(b.status.table_header_sortField!==i){b.status.table_header_sortFieldOrder=""}b.status.table_header_sortField=i;if(b.status.table_header_sortFieldOrder==="ASC"){b.status.table_header_sortFieldOrder="DESC";g.addClass("asc").removeClass("desc")}else{b.status.table_header_sortFieldOrder="ASC";g.addClass("desc").removeClass("asc")}b.status.table_header_sortLastButton=g;b.functions.paginate();return this};b.init=function(g){b.status.itemsPerPage=e(b.htmlBindings.drpItemPerPageValue).text();f.init(g);b.functions.bindEventHandlers();return this}}).call(this);