(function(){var d,f,b,e,a,c;c=window;d=c.jQuery;b=c.App;a=c.dandelion;f=a.namespace("App.APDashboard",c);e=b.APDashboard.DynamicFilter;f.status={};f.status.itemsPerPage=50;f.status.table_header_sortLastButton=null;f.status.table_header_sortField="vendno";f.status.table_header_sortFieldOrder="ASC";f.status.currentPage=1;f.status.currentVendno="";f.status.currentSet="details";f.status.currentBalance="0.0";f.status.modal_detail_CurrentTicket="";f.status.modal_detail_CurrentPage=1;f.status.modal_detail_ItemsPerPage=10;f.dictionaries={};f.htmlBindings={};f.htmlBindings.container=".container";f.htmlBindings.itemCounter="#panelHeadingItemsCount";f.htmlBindings.drpItemPerPage=".top-pager-itemmperpage-control a";f.htmlBindings.drpItemPerPageValue=".top-pager-itemmperpage-control button span.value";f.htmlBindings.filterForm="#filterForm";f.htmlBindings.table="#apDashboardTable";f.htmlBindings.table_header_btnSort=".btn-table-sort";f.htmlBindings.table_body_btnCustNo=".btn-vendno-form-link";f.htmlBindings.table_body_btnCurrent=".btn-current-form-link";f.htmlBindings.table_body_btn11_30=".btn-11-30-form-link";f.htmlBindings.table_body_btn31_45=".btn-31-45-form-link";f.htmlBindings.table_body_btn46_60=".btn-46-60-form-link";f.htmlBindings.table_body_btn61_90=".btn-61-90-form-link";f.htmlBindings.table_body_btnMoreThan90=".btn-more-than-90-form-link";f.htmlBindings.table_body_btnAttach=".btn-files-dialog";f.htmlBindings.pager_container=".pager-wrapper";f.htmlBindings.pager_btnPagerPages=".pager-btn";f.htmlBindings.modal_Details="#details_modal";f.htmlBindings.modal_Details_balance="#balance";f.htmlBindings.modal_Details_Pager_container=".pager-wrapper-details";f.htmlBindings.modal_Details_Pager_btnPagerPages=".pager-btn";f.htmlBindings.modal_Details_Table="#details";f.functions={};f.functions.updateDetailSumary=function(j){var i,g,h;h=accounting.formatMoney(j.balance,"$ ");g=accounting.formatMoney(j.balancePortion,"");if(j.setname===""){i=j.vendno+" balance: "+h}else{i=" "+j.vendno+" [ "+j.setname+" ] balance: "+h}d(f.htmlBindings.modal_Details_balance).text(i);return this};f.functions.paginate=function(){d.ajax({data:{predicate:f.DynamicFilter.functions.getPredicate(),page:f.status.currentPage,itemsPerPage:f.status.itemsPerPage,orderby:f.status.table_header_sortField,order:f.status.table_header_sortFieldOrder},url:f.urls.getPage,type:"post",beforeSend:function(){return d(".loading").show()},success:function(j,m,k){var l,g,i,h;l=d.parseJSON(j);g=new BootstrapPager(l,f.eventHandlers.pager_btnPagerPages_onClick);h=g.getCurrentPagedItems();i=g.getPagerControl();d(f.htmlBindings.pager_container).empty().append(i);f.functions.updateTable(h);d(f.htmlBindings.itemCounter).html(g.itemsCount);return d(".loading").hide()}});return this};f.functions.updateTable=function(g){var i,j,h;i=d(f.htmlBindings.table);j=i.children("tbody");j.empty();for(h in g){if(g.hasOwnProperty(h)){j.append(f.functions.buildTableItem(g[h],"","item-field"))}}f.functions.bindTableItemsEventHandlers();return this};f.functions.buildTableItem=function(p,l,o){var w,n,j,t,m,i,r,s,k,q,u,x,v,h,g;w=c.document;n=w.createElement("tr");t=function(z,y){var A;A=w.createElement("td");A.className=y;A.appendChild(w.createTextNode(z));return A};h=function(B,A,y){var z,C;C=w.createElement("td");z=w.createElement("a");z.href="#";z.className=A;z.dataset.vendno=p.vendno;if(typeof B==="string"){z.appendChild(w.createTextNode(B))}else{z.appendChild(B)}C.className=y||o;C.appendChild(z);return C};j=function(E,A){var z,D,B,C,y;y=w.createElement("select");C=w.createElement("option");C.appendChild(w.createTextNode("Empty"));y.appendChild(C);for(B in A){if(A.hasOwnProperty(B)){z=A[B].id;D=A[B].descrip;C=w.createElement("option");if(E===z){C.selected="selected"}C.value=z;C.appendChild(w.createTextNode(D));y.appendChild(C)}}y.className="form-control update-dropdown";return y};g=function(A,C,z){var y,B;B=w.createElement("td");y=j(A,C);y.dataset.ordnum=p.ordnum;y.className+=" select2-nosearch "+z;B.appendChild(y);return B};s=function(){return h(p.vendno,f.htmlBindings.table_body_btnCustNo.slice(1))};i=function(){return t(p.company)};r=function(){if(p.current==="0"){return t(accounting.formatMoney(p.current,""),"currency")}else{return h(accounting.formatMoney(p.current,""),f.htmlBindings.table_body_btnCurrent.slice(1),"currency")}};k=function(){if(p["11-30"]==="0"){return t(accounting.formatMoney(p["11-30"],""),"currency")}else{return h(accounting.formatMoneyformatMoney(p["11-30"],""),f.htmlBindings.table_body_btn11_30.slice(1),"currency")}};q=function(){if(p["31-45"]==="0"){return t(accounting.formatMoney(p["31-45"],""),"currency")}else{return h(accounting.formatMoney(p["31-45"],""),f.htmlBindings.table_body_btn31_45.slice(1),"currency")}};u=function(){if(p["46-60"]==="0"){return t(accounting.formatMoney(p["46-60"],""),"currency")}else{return h(accounting.formatMoney(p["46-60"],""),f.htmlBindings.table_body_btn46_60.slice(1),"currency")}};x=function(){if(p["61-90"]==="0"){return t(accounting.formatMoney(p["61-90"],""),"currency")}else{return h(accounting.formatMoney(p["61-90"],""),f.htmlBindings.table_body_btn61_90.slice(1),"currency")}};v=function(){if(p[">91"]==="0"){return t(accounting.formatMoney(p[">91"],""),"currency")}else{return h(accounting.formatMoney(p[">91"],""),f.htmlBindings.table_body_btnMoreThan90.slice(1),"currency")}};m=function(){return t(accounting.formatMoney(p.balance,""),"currency")};n.className=l;n.appendChild(s());n.appendChild(i());n.appendChild(r());n.appendChild(k());n.appendChild(q());n.appendChild(u());n.appendChild(x());n.appendChild(v());n.appendChild(m());return n};f.functions.bindTableItemsEventHandlers=function(){d(f.htmlBindings.table_body_btnCustNo).on("click",f.eventHandlers.table_body_btnCustNo_onClick);d(f.htmlBindings.table_body_btnCurrent).on("click",f.eventHandlers.table_body_btnCustNo_onClick);d(f.htmlBindings.table_body_btn11_30).on("click",f.eventHandlers.table_body_btnCustNo_onClick);d(f.htmlBindings.table_body_btn31_45).on("click",f.eventHandlers.table_body_btnCustNo_onClick);d(f.htmlBindings.table_body_btn46_60).on("click",f.eventHandlers.table_body_btnCustNo_onClick);d(f.htmlBindings.table_body_btn61_90).on("click",f.eventHandlers.table_body_btnCustNo_onClick);d(f.htmlBindings.table_body_btnMoreThan90).on("click",f.eventHandlers.table_body_btnCustNo_onClick);return this};f.functions.bindEventHandlers=function(){d(f.htmlBindings.drpItemPerPage).on("click",f.eventHandlers.drpItemPerPage_onClick);d(f.htmlBindings.table_header_btnSort).on("click",f.eventHandlers.table_body_btnSort_onClick);d(f.htmlBindings.pager_btnPagerPages).on("click",f.eventHandlers.pager_btnPagerPages_onClick);f.functions.bindTableItemsEventHandlers();return this};f.functions.modal_details_paginate=function(){d.ajax({data:{setname:f.status.currentSet,page:f.status.modal_detail_CurrentPage,itemsPerPage:f.status.modal_detail_ItemsPerPage,vendno:f.status.currentVendno,balance:f.status.currentBalance},url:f.urls.getVendnoDetailPage,type:"post",beforeSend:function(){return d(".loading").show()},success:function(j){var k,g,i,h;k=d.parseJSON(j);g=new BootstrapPager(k,f.eventHandlers.modal_details_pager_btnPagerPages_onClick);h=g.getCurrentPagedItems();i=g.getPagerControl();d(f.htmlBindings.modal_Details_Pager_container).empty().append(i);f.functions.modal_details_updateTable(h);f.functions.updateDetailSumary(k);return d(".loading").hide()}});return this};f.functions.modal_details_updateTable=function(g){var i,j,h;i=d(f.htmlBindings.modal_Details_Table);j=i.children("tbody");j.empty();for(h in g){if(g.hasOwnProperty(h)){j.append(f.functions.modal_details_buildTableItem(g[h],"","item-field"))}}f.functions.modal_details_bindTableItemsEventHandlers();return this};f.functions.modal_details_buildTableItem=function(j,s,n){var r,t,q,i,h,m,l,g,p,o,k;r=c.document;t=r.createElement("tr");q=function(v,u){var w;w=r.createElement("td");w.className=u;w.appendChild(r.createTextNode(v));return w};p=function(){return q(j.invno)};g=function(){return q(j.invdate)};l=function(){return q(j.duedate)};o=function(){return q(accounting.formatMoney(j.itotal,""),"currency")};m=function(){return q(accounting.formatMoney(j.disctotal,""),"currency")};i=function(){return q(accounting.formatMoney(j.amtpaid,""),"currency")};h=function(){return q(accounting.formatMoney(j.balance,""),"currency")};k=function(){return q(j.refno)};t.className=s;t.appendChild(p());t.appendChild(g());t.appendChild(l());t.appendChild(o());t.appendChild(m());t.appendChild(i());t.appendChild(h());t.appendChild(k());return t};f.functions.modal_details_bindTableItemsEventHandlers=function(){return this};f.eventHandlers={};f.eventHandlers.drpItemPerPage_onClick=function(h){var g,i;g=d(h.target);i=g.html();f.status.itemsPerPage=i;d(f.htmlBindings.drpItemPerPageValue).text(i);f.status.currentPage=1;f.functions.paginate();return this};f.eventHandlers.pager_btnPagerPages_onClick=function(h){var g,i;g=d(h.target);i=g.data("page");f.status.currentPage=i;f.functions.paginate();return this};f.eventHandlers.table_body_btnSort_onClick=function(h){var g,i;g=d(h.target);i=g.data("field");if(f.status.table_header_sortLastButton!==null){f.status.table_header_sortLastButton.removeClass("asc desc")}if(f.status.table_header_sortField!==i){f.status.table_header_sortFieldOrder=""}f.status.table_header_sortField=i;if(f.status.table_header_sortFieldOrder==="ASC"){f.status.table_header_sortFieldOrder="DESC";g.addClass("asc").removeClass("desc")}else{f.status.table_header_sortFieldOrder="ASC";g.addClass("desc").removeClass("asc")}f.status.table_header_sortLastButton=g;f.functions.paginate();return this};f.eventHandlers.table_body_btnCustNo_onClick=function(h){var g;g=d(h.target);f.status.currentVendno=g.data("vendno");f.status.currentBalance=g.text().trim();if(g.attr("class")===f.htmlBindings.table_body_btnCustNo.slice(1)){f.status.currentBalance=g.parent().parent().children(":last").text();f.status.currentSet="details"}if(g.attr("class")===f.htmlBindings.table_body_btnCurrent.slice(1)){f.status.currentSet="setCurrent"}else{if(g.attr("class")===f.htmlBindings.table_body_btn11_30.slice(1)){f.status.currentSet="set11_30"}else{if(g.attr("class")===f.htmlBindings.table_body_btn31_45.slice(1)){f.status.currentSet="set31_45"}else{if(g.attr("class")===f.htmlBindings.table_body_btn46_60.slice(1)){f.status.currentSet="set45_60"}else{if(g.attr("class")===f.htmlBindings.table_body_btn61_90.slice(1)){f.status.currentSet="set61_90"}else{if(g.attr("class")===f.htmlBindings.table_body_btnMoreThan90.slice(1)){f.status.currentSet="setGreatherThan90"}}}}}}d.ajax({data:{setname:f.status.currentSet,vendno:f.status.currentVendno,balance:f.status.currentBalance},url:f.urls.getVendnoDetailPage,type:"post",beforeSend:function(){return d(".loading").show()},success:function(l,o,m){var n,i,k,j;n=d.parseJSON(l);i=new BootstrapPager(n,f.eventHandlers.modal_details_pager_btnPagerPages_onClick);j=i.getCurrentPagedItems();k=i.getPagerControl();d(f.htmlBindings.modal_Details_Pager_container).empty().append(k);f.functions.modal_details_updateTable(j);f.functions.updateDetailSumary(n);d(f.htmlBindings.modal_Details).modal();return d(".loading").hide()}});return this};f.eventHandlers.modal_details_pager_btnPagerPages_onClick=function(h){var g,i;g=d(h.target);i=g.data("page");f.status.modal_detail_CurrentPage=i;f.status.currentSet;f.functions.modal_details_paginate();return this};f.init=function(g){f.status.itemsPerPage=d(f.htmlBindings.drpItemPerPageValue).text();e.init(g);return f.functions.bindEventHandlers()}}).call(this);